<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:106%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:18.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
address
	{mso-style-link:"HTML Address Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;
	font-style:italic;}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
span.HTMLAddressChar
	{mso-style-name:"HTML Address Char";
	mso-style-link:"HTML Address";
	font-family:"Times New Roman",serif;
	font-style:italic;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
p.msonormal0, li.msonormal0, div.msonormal0
	{mso-style-name:msonormal;
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.msochpdefault, li.msochpdefault, div.msochpdefault
	{mso-style-name:msochpdefault;
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.msopapdefault, li.msopapdefault, div.msopapdefault
	{mso-style-name:msopapdefault;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:106%;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.code-comment
	{mso-style-name:code-comment;}
span.code-keyword
	{mso-style-name:code-keyword;}
span.code-digit
	{mso-style-name:code-digit;}
span.code-string
	{mso-style-name:code-string;}
span.hljs-keyword
	{mso-style-name:hljs-keyword;}
span.hljs-string
	{mso-style-name:hljs-string;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.crayon-k
	{mso-style-name:crayon-k;}
span.crayon-h
	{mso-style-name:crayon-h;}
span.crayon-i
	{mso-style-name:crayon-i;}
span.crayon-sy
	{mso-style-name:crayon-sy;}
span.crayon-o
	{mso-style-name:crayon-o;}
span.crayon-s
	{mso-style-name:crayon-s;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:106%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-GB link=blue vlink="#954F72">

<div class=WordSection1>

<p class=MsoNormal><b><span style='font-size:12.0pt;line-height:106%;
font-family:"Century Gothic",sans-serif'>Wildcard String Searches – Should be avoided</span></b></p>

<p style='background:white;vertical-align:baseline'><span style='font-size:
11.0pt;font-family:"Calibri Light",sans-serif;color:#252525'>SQL Server is not
good at fuzzy string searching. That is, if I want to detect the presence of a
string in any position within a column, getting that data will be inefficient:</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>SELECT</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>Person.BusinessEntityID,</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>Person.FirstName,</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>Person.LastName,</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>Person.MiddleName</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>FROM Person.Person</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>WHERE Person.LastName LIKE '%For%';</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525'>If possible, it is best to avoid the first % as this results in
every character being matched against the value being searched. </span><span
style='font-family:"Calibri Light",sans-serif;color:#252525;background:white'>When
a “%” is placed at the beginning of a string, it makes the use of any ascending
index impossible. Similarly, when a “%” is at the end of a string, using a
descending index is also impossible</span>.</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525;background:white'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525;background:white'>Possible Solutions:</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif;
color:#252525;background:white'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>There
are a variety of ways to attack this situation, including:</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>Re-evaluate
the application. Is a wildcard search really needed in this manner? Do users
really want to search all parts of this column for a given string? If not, get
rid of this capability and the problem vanishes!</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>Can any
other filters be applied to the query to reduce the data size prior to
crunching the string comparison? It might be possible to filter by date, time,
status, or some other commonly used type of criteria, thereby reducing the data
needed to be scanned down to a small enough amount so that the query perform
acceptably.</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>Could
a leading string search be performed instead of a wildcard search? Can “%For%”
be changed to “For%”?</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>Is
full-text indexing an available option? Can it be implemented and used?</span></p>

<p class=MsoNoSpacing><span style='font-family:"Calibri Light",sans-serif'>Can a
query hash or n-gram solution be implemented?</span></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNormal><span style='color:#111111;background:white'><a
href="https://inteltext.github.io/index.html">Return to Index Page</a></span></p>

<p class=MsoNormal><b><span style='font-size:12.0pt;line-height:106%;
font-family:"Century Gothic",sans-serif'>&nbsp;</span></b></p>

</div>

</body>

</html>
